<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Interactivo de Logística</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2563eb"/>
    <link rel="apple-touch-icon" href="https://i.postimg.cc/Kv2jTDSr/image.png">
    <style>
        .hidden { display: none; }
        .correct { background-color: #d1fae5 !important; border-color: #10b981 !important; color: #065f46 !important; }
        .incorrect { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b !important; }
        .disabled { cursor: not-allowed; }
        body { padding-bottom: 60px; /* Space for the fixed footer */ }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">
    <div id="app" class="min-h-screen flex flex-col items-center justify-center p-4">
        
        <!-- Name Input Screen -->
        <div id="name-screen" class="w-full max-w-md mx-auto text-center bg-white p-8 rounded-2xl shadow-lg">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">¡Bienvenido!</h1>
            <p class="text-gray-600 mb-6">Por favor, introduce tu nombre para empezar.</p>
            <div class="space-y-4">
                <input type="text" id="name-input" placeholder="Escribe tu nombre aquí..." class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                <button id="submit-name-btn" class="w-full px-8 py-3 text-xl font-bold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 shadow-md">
                    Continuar
                </button>
            </div>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="hidden w-full max-w-4xl mx-auto text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900">
                Test Interactivo de <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-teal-400">Logística</span>
            </h1>
            <p id="welcome-message" class="text-gray-600 mt-2">Pon a prueba tus conocimientos</p>
            
            <!-- Bookmarks Section -->
            <div id="bookmarks-container" class="hidden mt-8 text-left max-w-lg mx-auto">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Preguntas Guardadas</h3>
                <div id="bookmarks-list" class="space-y-3 max-h-80 overflow-y-auto p-4 bg-white border border-gray-200 rounded-lg"></div>
                <div id="bookmark-quiz-button-container" class="mt-4 text-center"></div>
            </div>

            <!-- Search Functionality -->
            <div class="mt-8 max-w-lg mx-auto">
                <label for="search-input" class="sr-only">Buscar preguntas</label>
                <div class="relative">
                    <input type="text" id="search-input" placeholder="Buscar por tema o pregunta..." class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 pr-10">
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                </div>
            </div>
            
            <div id="start-screen-default-content" class="mt-6">
                <button id="start-quiz-btn" class="px-8 py-3 text-xl font-bold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 shadow-md">
                    Empezar Test Aleatorio
                </button>
            </div>

             <!-- Search Results -->
            <div id="search-results-container" class="hidden mt-8 text-left">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Resultados de la Búsqueda</h3>
                <div id="search-results-list" class="space-y-3 max-h-80 overflow-y-auto p-4 bg-white border border-gray-200 rounded-lg"></div>
                <div id="topic-quiz-button-container" class="mt-4 text-center"></div>
                <p id="no-results-message" class="hidden text-center text-gray-500 mt-4">No se encontraron preguntas. Intenta con otra búsqueda.</p>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden w-full max-w-3xl bg-white p-6 md:p-8 rounded-2xl shadow-lg">
            <div class="flex justify-between items-center mb-6">
                <p id="progress-text" class="text-gray-600 font-semibold">Pregunta 1 / 20</p>
                
                <button id="bookmark-btn" class="p-2 rounded-full hover:bg-yellow-100 transition" aria-label="Guardar pregunta">
                    <!-- SVG will be dynamically inserted here -->
                </button>

                <div class="flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <p id="timer" class="text-lg font-bold text-blue-600">00:00</p>
                </div>
            </div>
            <div>
                <div id="question-image-container" class="mb-4"></div>
                <h3 id="question-text" class="text-xl md:text-2xl font-bold mb-6 text-gray-900"></h3>
                <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
            </div>
            <div id="next-button-container" class="mt-6 text-center"></div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden w-full max-w-2xl text-center bg-white p-8 rounded-2xl shadow-lg">
            <h2 id="results-title" class="text-3xl font-bold text-gray-900 mb-2"></h2>
            <p id="results-message" class="text-lg text-gray-600 mb-6"></p>
            
            <p id="final-time" class="text-lg text-gray-500 mb-2"></p>

            <div id="score-display" class="text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-teal-400 mb-2"></div>
            <p id="score-percentage" class="text-2xl font-semibold text-gray-500 mb-8"></p>

            <div id="results-buttons" class="space-y-4 md:space-y-0 md:space-x-4 md:flex justify-center"></div>

            <div id="review-section" class="hidden mt-8 text-left max-h-60 overflow-y-auto p-4 bg-gray-50 border border-gray-200 rounded-lg">
                <h4 class="text-lg font-semibold mb-2 text-gray-700">Preguntas para repasar:</h4>
                <ul id="incorrect-questions-list"></ul>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer id="app-footer" class="fixed bottom-0 left-0 w-full p-3 z-10 text-gray-700 bg-gray-100 border-t border-gray-300 text-center">
        <p class="text-sm">Creado por Avtandil </p>
    </footer>

    <script>
        const allQuestions = [
            // Page 1
            { questionText: "¿Cuál es el objetivo principal en la cima de la pirámide logística?", options: ["Reducir costes al mínimo", "Dar al cliente lo que quiere", "Optimizar el tiempo de entrega", "Asegurar la calidad de los recursos"], correctAnswerIndex: 1 },
            { questionText: "En la pirámide logística, ¿qué elemento sostiene la base del proceso?", options: ["La calidad del producto", "Recursos/costes y tiempo", "La trazabilidad de la mercancía", "La comunicación entre equipos"], correctAnswerIndex: 1 },
            { questionText: "El nivel medio de la pirámide logística indica que la calidad es fundamental para alcanzar el objetivo principal.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Quién es el cliente externo?", options: ["El trabajador del proceso posterior", "El que nos vende bienes y servicios", "El que paga por nuestros bienes o servicios", "El compañero que realiza la tarea anterior"], correctAnswerIndex: 2 },
            { questionText: "¿Qué define al proveedor interno?", options: ["El que recibe el trabajo en el proceso posterior", "El que nos vende bienes externos", "El trabajador respecto del proceso anterior", "El consumidor final de la cadena"], correctAnswerIndex: 2 },
            // Page 2
            { questionText: "El cliente interno es el transportista que entrega la mercancía al almacén.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Qué significa eficacia en logística?", options: ["Conseguir los objetivos con el menor número de recursos", "Reducir el tiempo de almacenamiento", "Alcanzar los objetivos", "Minimizar los errores de facturación"], correctAnswerIndex: 2 },
            { questionText: "La eficiencia se centra en lograr un producto con un coste logístico aceptable.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Cuál es la primera actividad en la secuencia de un almacén?", options: ["Área de picking", "Muelle / Área de descarga", "Área de expedición", "Playa de envíos"], correctAnswerIndex: 1 },
            { questionText: "El flujo del almacén sigue: proveedores → almacén → producción → almacén (producto final) → cliente externo.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            // Page 3
            { questionText: "¿Qué incluye el área de almacenaje?", options: ["Solo la zona de picking", "Silos o zonas buffer/pulmón de ubicación", "Playa de expediciones", "Área de envíos"], correctAnswerIndex: 1 },
            { questionText: "Los espacios de reciclaje forman parte de los espacios auxiliares de un almacén.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Cuál es una característica de la descarga en muelle (trasera)?", options: ["Requiere mucho espacio exterior para maniobras", "Se aplica el principio LIFO (Last In, First Out)", "Solo se usa para vehículos abiertos", "Implica mayor riesgo de caída de mercancía"], correctAnswerIndex: 1 },
            { questionText: "En la descarga en plano se necesita carretilla elevadora o apilador eléctrico.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué documento acredita la entrega cuando el cliente lo firma?", options: ["Carta de porte", "Factura comercial", "Albarán", "Pedido de compra"], correctAnswerIndex: 2 },
            // Page 4
            { questionText: "El proceso de recepción comienza con la verificación del precinto del vehículo.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué se comprueba en la descarga durante la recepción?", options: ["Solo la cantidad", "Cantidad, desperfectos y manipulaciones", "Coste logístico total", "Motivación del transportista"], correctAnswerIndex: 1 },
            { questionText: "La verificación en recepción puede realizarse con PDA para mayor precisión.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Para qué sirve el área de cuarentena o devolución?", options: ["Almacenar productos finales listos", "Guardar mercancía en espera de devolución o revisión", "Preparar pedidos de picking", "Reciclar embalajes vacíos"], correctAnswerIndex: 1 },
            { questionText: "El área de cuarentena debe estar cerrada con llave para evitar robos.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Qué provoca un cuello de botella en el flujo del almacén?", options: ["Aumento de rotación de stock", "El flujo se detiene por falta de ritmo", "Mayor eficiencia en expedición", "Reducción de costes en personal"], correctAnswerIndex: 1 },
            // Page 5
            { questionText: "Una consecuencia de un cuello de botella para el cliente externo es la pérdida de imagen.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Cuál es una causa común de cuello de botella?", options: ["Exceso de inversión en maquinaria", "Maquinaria defectuosa o obsoleta", "Formación excesiva del personal", "Organización perfecta de tiempos"], correctAnswerIndex: 1 },
            { questionText: "Para el cliente interno, un cuello de botella implica personal parado y aumento de costes.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué tipo de almacén contiene materia prima y productos semielaborados?", options: ["Comercial", "Industrial", "De tránsito", "Para mercancías peligrosas"], correctAnswerIndex: 1 },
            { questionText: "Los almacenes comerciales son el punto final de la cadena y contienen mercancía para el cliente final.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            // Page 6
            { questionText: "¿Qué diferencia a un almacén cubierto de uno descubierto?", options: ["Ofrece menos seguridad pero es más barato", "Protege del clima y ofrece más seguridad, pero es más caro", "Se usa solo para picking", "No requiere espacios auxiliares"], correctAnswerIndex: 1 },
            { questionText: "Los almacenes para mercancías peligrosas no siguen una normativa específica.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Qué define a un grupo?", options: ["Conjunto de personas con objetivos comunes y sinergia", "Conjunto de personas que trabajan juntas sin compartir metas", "Equipo con habilidades complementarias", "Personal motivado con líder fijo"], correctAnswerIndex: 0 },
            { questionText: "Un equipo eficaz requiere sinergia, donde el resultado es superior a la suma de las partes individuales.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Cuáles son las tres grandes áreas de gestión del almacén?", options: ["Recepción, picking y salida", "Operativo, documental (administrativo) y comercial", "Industrial, comercial y de tránsito"], correctAnswerIndex: 1 },
            // Page 7
            { questionText: "El espíritu de equipo implica trabajar de forma coordinada con un líder y compromiso.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué es la comunicación?", options: ["Solo el intercambio verbal entre emisor y receptor", "Capacidad de relacionarse con el entorno (emisor → mensaje → receptor)", "Herramienta solo para resolver conflictos", "Proceso que ignora la asertividad"], correctAnswerIndex: 1 },
            { questionText: "La comunicación en el almacén puede ser verbal o no verbal.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué caracteriza la asertividad en la comunicación?", options: ["Imponer decisiones sin reconocer errores", "Resolver conflictos buscando soluciones y reconociendo errores", "Evitar toda relación con el entorno", "Cambiar a los demás sin auto-reflexión"], correctAnswerIndex: 1 },
            { questionText: "Para evaluar la calidad del trabajo, una pregunta clave es: \"¿Se cumplen los objetivos?\".", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            // Page 8
            { questionText: "¿Cuál es un indicador de calidad en el almacén?", options: ["Aumento intencional de tiempo perdido en expedición", "Tasa de rotura de stock", "Ignorar el servicio postventa", "Errores voluntarios en facturación"], correctAnswerIndex: 1 },
            { questionText: "El índice de satisfacción del cliente no es un indicador de calidad.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Qué es el estándar GS1-128?", options: ["Un sistema para control de stock mínimo", "Sistema de códigos de barras para identificación de productos", "Método de pago internacional", "Herramienta para gestión de personal"], correctAnswerIndex: 1 },
            { questionText: "Los productos se clasifican jerárquicamente: Familia → Subfamilia → Grupo → Subgrupo.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué permite la trazabilidad en la cadena de suministro?", options: ["Solo reducir costes de transporte", "Seguimiento (tracking y tracing) del lote, fecha y hora del producto", "Aumentar el tiempo de picking", "Eliminar la necesidad de PDA"], correctAnswerIndex: 1 },
            // Page 9
            { questionText: "El EDI (Intercambio Electrónico de Datos) no se usa para intercambiar documentos digitales.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Qué ventaja ofrece una PDA en el movimiento de mercancía?", options: ["Aumenta los errores y el tiempo", "Facilita codificación, identificación y trazabilidad, reduciendo costes", "Solo se usa para comunicación verbal", "Elimina la necesidad de espacios auxiliares"], correctAnswerIndex: 1 },
            { questionText: "Una PDA reduce el tiempo de trabajo y aumenta la seguridad en el almacén.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué incluye el espacio dedicado a la logística inversa en un almacén?", options: ["Solo oficinas y vestuarios", "Gestión de devoluciones y reciclaje", "Área de picking exclusiva", "Parking para vehículos externos"], correctAnswerIndex: 1 },
            { questionText: "Los pasillos y zonas de tránsito no son espacios necesarios para el almacenaje.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            // Page 10
            { questionText: "En la recepción, después de la descarga, se emiten etiquetas y se distribuye la mercancía.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "Un almacén es un local para depositar mercancías para su posterior venta o distribución.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué materiales auxiliares se almacenan en un almacén industrial?", options: ["Solo productos finales", "Materiales de mantenimiento y embalajes", "Mercancía para cliente final", "Solo granjas para animales"], correctAnswerIndex: 1 },
            { questionText: "La flexibilidad y motivación no son características de un equipo eficaz.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Qué se entiende por aprovisionamiento?", options: ["Actividad de recibir devoluciones", "Proceso de adquisición y suministro de materiales o productos", "Operación exclusiva de picking", "Solo gestión de documentación administrativa"], correctAnswerIndex: 1 },
            { questionText: "El stock de seguridad sirve para evitar roturas de stock por variaciones en la demanda.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            // Page 11
            { questionText: "¿Qué es el \"picking\"?", options: ["Selección y preparación de pedidos para clientes", "Recepción inicial de la mercancía", "Proceso de devolución de productos", "Control financiero de facturas"], correctAnswerIndex: 0 },
            { questionText: "El cross-docking consiste en almacenar mercancía durante largos periodos antes de su expedición.", options: ["Verdadero", "Falgo"], correctAnswerIndex: 1 },
            { questionText: "¿Qué es un código QR?", options: ["Un código bidimensional que almacena más información que un código de barras tradicional", "Un documento para transporte internacional", "Un sistema de gestión administrativa", "Una norma de trazabilidad física"], correctAnswerIndex: 0 },
            { questionText: "El embalaje protege la mercancía durante transporte y almacenaje.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué significa FIFO?", options: ["First In, First Out (primero en entrar, primero en salir)", "Free Input, Free Output", "Fast Information for Operators", "Flexible Inventory for Orders"], correctAnswerIndex: 0 },
            // Page 12
            { questionText: "El método LIFO significa que la última mercancía en entrar es la primera en salir.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué es un stock obsoleto?", options: ["Productos deteriorados, caducados o que ya no tienen salida comercial", "Mercancía lista para cross-docking", "Pedidos en preparación", "Material auxiliar"], correctAnswerIndex: 0 },
            { questionText: "La rotación de stock mide la frecuencia con que un producto se repone en el almacén.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué permite el código EAN-13?", options: ["Identificación internacional de productos con 13 dígitos", "Gestión de personal en un almacén", "Elaboración de facturas", "Clasificación por familias"], correctAnswerIndex: 0 },
            { questionText: "Un layout de almacén bien diseñado facilita flujos y reduce tiempos.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            // Page 13
            { questionText: "¿Qué es el cross-docking?", options: ["Técnica para evitar almacenamiento, distribuyendo directamente la mercancía", "Almacenaje prolongado en cámaras", "Método de rotación de stock", "Estrategia de motivación de personal"], correctAnswerIndex: 0 },
            { questionText: "El just in time consiste en producir o entregar lo necesario en el momento justo.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué se entiende por logística inversa?", options: ["Devolución, reciclaje o reaprovechamiento de productos", "Solo distribución al cliente", "Técnica de almacenamiento FIFO", "Embalaje para exportación"], correctAnswerIndex: 0 },
            { questionText: "La logística inversa no forma parte de la cadena de suministro.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "¿Qué herramienta facilita la comunicación electrónica entre empresas?", options: ["PDA", "EDI", "Código QR", "Palet"], correctAnswerIndex: 1 },
            // Page 14
            { questionText: "El EDI permite intercambiar documentos como pedidos y facturas de manera digital.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué es un KPI en logística?", options: ["Indicador clave de desempeño (Key Performance Indicator)", "Documento de aduanas", "Tipo de embalaje", "Método de etiquetado"], correctAnswerIndex: 0 },
            { questionText: "Los KPI ayudan a medir la eficacia de las operaciones logísticas.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué significa trazabilidad hacia atrás?", options: ["Seguir el recorrido del producto desde el cliente hasta el origen", "Solo controlar stock en almacén", "Método de rotación de mercancía", "Sinónimo de FIFO"], correctAnswerIndex: 0 },
            { questionText: "La trazabilidad hacia adelante consiste en conocer a quién se entregó cada lote.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué es la ergonomía en el almacén?", options: ["Adaptación del puesto de trabajo para mejorar seguridad y rendimiento", "Sistema de etiquetado", "Método de rotación LIFO", "Software de picking"], correctAnswerIndex: 0 },
            // Page 15
            { questionText: "La ergonomía busca reducir riesgos laborales y aumentar la eficiencia.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué documento se utiliza en la recepción de mercancía?", options: ["Albarán", "Factura proforma", "Código QR", "Layout"], correctAnswerIndex: 0 },
            { questionText: "El albarán es un documento que justifica la entrega de la mercancía.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué es un palet?", options: ["Plataforma que facilita manipulación y transporte de mercancías", "Documento aduanero", "Software de trazabilidad", "Indicador KPI"], correctAnswerIndex: 0 },
            { questionText: "El europalet mide 1200 x 800 mm.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            // Page 16
            { questionText: "¿Qué es un contenedor?", options: ["Caja de grandes dimensiones para transporte internacional de mercancías", "Documento de devolución", "Equipo de protección personal", "Etiqueta RFID"], correctAnswerIndex: 0 },
            { questionText: "Los contenedores marítimos permiten transporte intermodal (barco, tren, camión).", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Cuál es la función principal del \"Albarán\"?", options: ["Documento de pago.", "Confirmación de entrega y verificación de la mercancía.", "Cancelación del pedido.", "Horario de ruta para el transportista."], correctAnswerIndex: 1 },
            { questionText: "¿Qué significa \"Orden descendente\" en las partes de trabajo?", options: ["Del empleado al jefe.", "Del jefe al empleado, indicando lo que debe hacer el empleado.", "Del cliente al proveedor.", "Ruta de transporte."], correctAnswerIndex: 1 },
            // Page 17
            { questionText: "¿Para qué sirve la \"Nota de entrega\"?", options: ["Confirmación de pago.", "Trazabilidad interna, pedidos internos o por urgencia, generalmente sin valor.", "Inventario del almacén.", "Control de rotación."], correctAnswerIndex: 1 },
            { questionText: "En un albarán, ¿qué significa \"Portes pagado\"?", options: ["El cliente paga el transporte.", "El proveedor paga el transporte.", "Transporte gratuito.", "Cancelación del envío."], correctAnswerIndex: 1 },
            { questionText: "¿Cuál es el primer documento en la trazabilidad de la documentación?", options: ["Picking list.", "Orden de pedido (del cliente al proveedor).", "Carta de porte.", "Factura."], correctAnswerIndex: 1 },
            { questionText: "¿Qué significa el principio FiFo en la rotación?", options: ["Lo último que entra, lo primero que sale.", "Lo primero que entra, lo primero que sale.", "Lo primero que caduca, lo primero que sale.", "Lo más barato primero."], correctAnswerIndex: 1 },
            // Page 18
            { questionText: "Según la regla de Pareto, ¿qué representa la categoría A?", options: ["50% de referencias, 5% de rotación.", "20% de referencias, 80% de rotación (alta rotación).", "30% de referencias, 15% de rotación.", "Baja rotación."], correctAnswerIndex: 1 },
            { questionText: "¿Cuál es una consecuencia negativa de una mala rotación?", options: ["Mejora en la ubicación.", "Incremento de movimientos para facilitar la rotación (aumento de costes).", "Alta ocupación del espacio.", "Menos stock fantasma."], correctAnswerIndex: 1 },
            { questionText: "¿Qué actividades mejoran la facilidad de rotación?", options: ["Ignorar el stock.", "Frentear (frente), colocación en fondo, orden y limpieza.", "Acumular mercancía antigua.", "Ventas urgentes sin control."], correctAnswerIndex: 1 },
            { questionText: "¿Qué causa el \"stock fantasma\"?", options: ["Buena ubicación.", "Mala ocupación del espacio y desaparición de mercancía.", "Alta rotación.", "Sistemas automáticos."], correctAnswerIndex: 1 },
            // Page 19
            { questionText: "¿Cuál es la ventaja principal del \"Acceso Directo\" en sistemas de almacenaje?", options: ["Pocas referencias, muchas unidades por referencia.", "Muchas referencias, pocas unidades por referencia, accesibilidad a todas.", "Sin accesibilidad.", "Solo LiFo."], correctAnswerIndex: 1 },
            { questionText: "¿Qué caracteriza al sistema \"Cantilever\"?", options: ["Dinámico por gravedad.", "Para productos largos, aprovechamiento del espacio malo, poco mantenimiento.", "Automático.", "En bloque."], correctAnswerIndex: 1 },
            { questionText: "¿Qué describe al sistema \"Drive Through\"?", options: ["LiFo, un pasillo.", "FiFo, buen espacio (pero necesita 2 pasillos), poco mantenimiento, rígido.", "Ni FiFo ni LiFo.", "Solo alta rotación."], correctAnswerIndex: 1 },
            { questionText: "¿Qué sistema requiere mucho mantenimiento y es muy rígido?", options: ["Estantería convencional.", "Sistemas automáticos (transelevadores), hasta 30m de altura, máximo mantenimiento.", "En bloque.", "Flow Rail."], correctAnswerIndex: 1 },
            // Page 20
            { questionText: "¿Qué es el sistema \"Push Back\"?", options: ["FiFo, 2 pasillos.", "LiFo, buen espacio (1 pasillo), mucho mantenimiento, muy rígido.", "Acceso directo.", "Para productos largos."], correctAnswerIndex: 1 },
            { questionText: "¿Qué es la Ley 31/1995?", options: ["Regulación de transporte.", "Prevención de riesgos laborales.", "Construcción de almacenes.", "Reglas de rotación."], correctAnswerIndex: 1 },
            { questionText: "¿Qué define \"Riesgo laboral\"?", options: ["Posibilidad de que un trabajador sufra daño derivado del trabajo.", "Estado de salud.", "Enfermedad.", "Solo accidente."], correctAnswerIndex: 0 },
            { questionText: "¿Cuál es una obligación del trabajador según la LPRL?", options: ["Ignorar riesgos.", "Usar correctamente máquinas, informar de riesgos, cooperar en seguridad.", "Solo formación.", "Ignorar al empresario."], correctAnswerIndex: 1 },
            // Page 21
            { questionText: "¿Qué es un \"Accidente laboral\" en definición preventiva?", options: ["Enfermedad profesional.", "Suceso súbito no deseado que causa pérdidas a personas, propiedad o procesos.", "Estado de bienestar.", "Solo lesión corporal."], correctAnswerIndex: 1 },
            { questionText: "¿Qué derecho tienen los trabajadores según los Arts. 14-23 de la LPRL?", options: ["Ignorar equipos de protección.", "Evaluación de riesgos, formación, medidas de emergencia.", "Solo pago de salarios.", "Cancelación de contratos."], correctAnswerIndex: 1 },
            { questionText: "¿Cuál es la principal característica del sistema de \"Acceso Directo\"?", options: ["Pocas referencias y muchas unidades por referencia.", "Muchas referencias, pocas unidades por referencia y accesibilidad a todas las referencias.", "No accesibilidad a las referencias.", "Solo para productos de alta rotación."], correctAnswerIndex: 1 },
            { questionText: "¿Qué describe al sistema de \"Alta Compactación\"?", options: ["Muchas referencias y accesibilidad total.", "Pocas referencias, muchas unidades por referencia y no accesibilidad a las referencias.", "Flexible para cualquier tipo de producto.", "Bajo mantenimiento siempre."], correctAnswerIndex: 1 },
            // Page 22
            { questionText: "¿Cuáles son las características principales del \"Sistema de estantería convencional o Rack System\"?", options: ["FiFo, buen espacio, mucho mantenimiento.", "Ni FiFo, ni LiFo, ni FeFo; aprovechamiento del espacio malo, poco mantenimiento, sistema flexible.", "Solo para productos largos.", "Accesibilidad limitada."], correctAnswerIndex: 1 },
            { questionText: "¿Para qué tipo de productos es adecuado el \"Sistema convencional\"?", options: ["Productos de baja rotación exclusivamente.", "Cualquier tipo, pero con rotación media o alta preferiblemente.", "Solo mercancías peligrosas.", "Productos caducados."], correctAnswerIndex: 1 },
            { questionText: "¿Qué ventaja tiene el \"Sistema de estantería con base móvil (MovaRack)\"?", options: ["Malo aprovechamiento del espacio.", "Buen aprovechamiento del espacio (solo 1 pasillo), pero mucho mantenimiento.", "Ni FiFo ni LiFo.", "Para productos de baja rotación solo."], correctAnswerIndex: 1, imageUrl: 'https://i.postimg.cc/vH2JdYhn/Almacenaje-m-vil.jpg' },
            { questionText: "¿Para qué se utiliza principalmente el \"Sistema Cantilever\"?", options: ["Productos pequeños y frágiles.", "Productos largos, con aprovechamiento del espacio malo y poco mantenimiento.", "Mercancías peligrosas.", "Alta compactación."], correctAnswerIndex: 1, imageUrl: 'https://i.postimg.cc/c4kpNxhn/Sistema-Cantilever.jpg' },
            { questionText: "¿Cuáles son las características del \"Sistema Flow Rail\"?", options: ["FiFo, espacio muy bueno.", "Ni FiFo, ni LiFo, ni FeFo; aprovechamiento del espacio intermedio, mucho mantenimiento.", "Sin mantenimiento.", "Rígido para productos largos."], correctAnswerIndex: 1 },
            // Page 23
            { questionText: "¿Qué rotación utiliza el \"Sistema en bloque\"?", options: ["FiFo.", "LiFo, con aprovechamiento del espacio muy bueno y sin mantenimiento.", "FeFo.", "Ni uno ni otro."], correctAnswerIndex: 1 },
            { questionText: "¿Qué describe al \"Sistema Drive In\"?", options: ["FiFo, necesita 2 pasillos.", "LiFo, solo un espacio de carga, poco mantenimiento, rígido.", "Mucho mantenimiento.", "Flexible para cualquier referencia."], correctAnswerIndex: 1 },
            { questionText: "¿Cuáles son las diferencias clave del \"Sistema Drive Through\" respecto al Drive In?", options: ["LiFo, un pasillo.", "FiFo, buen espacio pero necesita 2 pasillos, poco mantenimiento, rígido.", "Ni FiFo ni LiFo.", "Alto mantenimiento."], correctAnswerIndex: 1 },
            { questionText: "¿Qué rotación y características tiene el \"Sistema Push Back\"?", options: ["FiFo, espacio intermedio.", "LiFo, buen espacio (1 pasillo), mucho mantenimiento, muy rígido.", "FeFo, sin mantenimiento.", "Para productos largos."], correctAnswerIndex: 1 },
            // Page 24
            { questionText: "¿Qué ventaja ofrece el \"Sistema de estanterías dinámicas por gravedad\"?", options: ["LiFo, 1 pasillo.", "FiFo, espacio bueno (2 pasillos, una unidad de carga), mucho mantenimiento, muy rígido.", "Poco mantenimiento.", "Flexible."], correctAnswerIndex: 1 },
            { questionText: "¿Qué incluye el \"Sistema Automático\" como transelevadores, miniload, bilateral o trilateral?", options: ["Solo LiFo, espacio malo.", "LiFo, FiFo o FeFo; buena espacio (hasta 30m altura), máximo mantenimiento, extremadamente rígido.", "Poco mantenimiento.", "Para baja rotación."], correctAnswerIndex: 1, imageUrl: 'https://i.postimg.cc/J4YfWrx1/Sistema-autom-ticos.jpg' },
            { questionText: "¿Para qué rotación es ideal el \"Sistema Automático\"?", options: ["Baja rotación.", "Alta rotación.", "Sin rotación específica.", "Solo media."], correctAnswerIndex: 1, imageUrl: 'https://i.postimg.cc/J4YfWrx1/Sistema-autom-ticos.jpg' },
            { questionText: "¿Qué es un \"Sistema Autoportante\"?", options: ["Estantería convencional con base móvil.", "Estructura integrada donde las estanterías forman parte del edificio, con alta rotación y mucho mantenimiento.", "Sistema manual.", "Para productos pequeños."], correctAnswerIndex: 1, imageUrl: 'https://i.postimg.cc/HsvqCYz7/Sistema-autoportante.jpg' },
            // Page 25
            { questionText: "¿Qué norma regula el mantenimiento de los sistemas de almacenaje?", options: ["Ley 31/1995.", "UNE-EN 15635, que incluye un plan de mantenimiento e inspección visual diaria.", "OMS.", "Ninguna específica."], correctAnswerIndex: 1 },
            { questionText: "¿Qué tipo de inspección se recomienda diariamente en los sistemas de almacenaje?", options: ["Técnica profunda por expertos.", "Visual diaria por personal del almacén, para anomalías visibles como deformaciones.", "Anual solo.", "Ninguna."], correctAnswerIndex: 1 },
            { questionText: "¿Cuál es una consecuencia de un mal sistema de almacenaje según las notas?", options: ["Menos costes.", "Desaparición de mercancía (agujero negro, stock fantasma), mala ocupación del espacio.", "Mayor flexibilidad.", "Alta accesibilidad siempre."], correctAnswerIndex: 1 },
            { questionText: "¿En qué se diferencia el \"Sistema en bloque\" de los automáticos?", options: ["Mucho mantenimiento vs. sin mantenimiento.", "LiFo, muy flexible y sin mantenimiento vs. máximo mantenimiento y rígido.", "FiFo vs. LiFo.", "Para muchas referencias vs. pocas."], correctAnswerIndex: 1 },
            { questionText: "¿Qué sistema es más adecuado para productos de rotación baja según Pareto?", options: ["Automáticos de alta altura.", "En bloque o Drive In, para pocas referencias y muchas unidades.", "Convencional.", "Cantilever."], correctAnswerIndex: 1 },
            // Page 26
            { questionText: "¿Qué sistema combina flexibilidad y bajo mantenimiento?", options: ["Sistemas automáticos.", "Estantería convencional.", "Push Back.", "Drive Through."], correctAnswerIndex: 1 },
            { questionText: "El almacén de materias auxiliares está destinado a almacenar:", options: ["Botes, botellas o cajas necesarios para empaquetar el producto final.", "Todo lo necesario para terminar el producto como: botones, cremalleras, etc.", "Los repuestos necesarios para que las máquinas no paren como: rodamientos, combustibles, aceites, etc."], correctAnswerIndex: 1 },
            { questionText: "El cross-dock es el almacén donde las mercancías permanecen de media un día hasta que son despachadas hacia su destino.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "En los muelles de carga y descarga nos encontramos los abrigos que:", options: ["Son un elemento que protege a los trabajadores de los muelles de las inclemencias del tiempo.", "Son el elemento fijo que envuelve las cajas de los camiones facilitando la carga y descarga.", "Son los elementos flexibles que envuelven las cajas de los camiones protegiendo la mercancía."], correctAnswerIndex: 2 },
            { questionText: "¿Cuál de las siguientes opciones no la encontramos en las zonas auxiliares de un almacén?", options: ["Zona botiquín.", "Aseos.", "Almacén de materiales auxiliares."], correctAnswerIndex: 2 },
            // Page 27
            { questionText: "La ruptura de stock es la situación que me puede producir:", options: ["Incrementar las ventas.", "Perder clientes.", "Mejorar mi imagen de empresa."], correctAnswerIndex: 1 },
            { questionText: "Las entradas y salidas de un almacén se puede producir tanto de materias primas como de productos terminados y siempre vendrán del exterior.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 1 },
            { questionText: "Las mermas de las mercancías en los almacenes se producen por robos o roturas.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "El destinatario de la mercancía deberá realizar la descarga sin la presencia del transportista.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 1 },
            { questionText: "La principal ventaja del cross-docking será:", options: ["El elevado tiempo de permanencia de la mercancía.", "La ausencia de stock.", "Toda la mercancía viene paletizada y no se ha de descomponer."], correctAnswerIndex: 1 },
            // Page 28
            { questionText: "En la cadena de suministros intervienen las empresas productoras, distribuidoras y comercializadoras de productos.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "Se denomina stock a:", options: ["Todas las mercancías que pedimos a nuestros proveedores.", "La mercancía que se ubica en nuestros almacenes.", "La mercancía que se recibe en el almacén."], correctAnswerIndex: 1 },
            { questionText: "En el sistema drive-in la entrada y salida de palés se produce por el mismo lado:", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "Las estanterías ideales para mercancías voluminosas se denominan:", options: ["Compactas de paletización.", "Dinámicas.", "Cantilever."], correctAnswerIndex: 2 },
            { questionText: "Las dimensiones del europalé homologado son:", options: ["1300×800×145 mm", "1200×145×800 mm", "1200×800×145 mm"], correctAnswerIndex: 2 },
            { questionText: "¿Cuál de las opciones no es un tipo de cross-docking?", options: ["Directo.", "Indirecto.", "Mixto."], correctAnswerIndex: 2 },
            // Page 29
            { questionText: "El picking consiste en recoger y agrupar todos los productos que un cliente nos ha pedido.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "No forma parte de la documentación de expedición:", options: ["Orden de picking.", "Factura.", "Albarán."], correctAnswerIndex: 1 },
            { questionText: "El cuello de botella es la situación que se produce cuando:", options: ["El almacén se encuentra lleno de mercancías.", "No se puede continuar el proceso productivo por falta de materiales.", "Estamos esperando que se inicie la producción."], correctAnswerIndex: 1 },
            { questionText: "Si en un almacén ubicamos las mercancías en el suelo obligatoriamente lo haremos en un sistema de almacenamiento.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 1 },
            { questionText: "Los sistemas pick to light y pick by voice son tecnologías que utilizan:", options: ["Señales luminosas únicamente.", "Señales luminosas y acústicas.", "Señales luminosas y verbales."], correctAnswerIndex: 1 },
            // Page 30
            { questionText: "En el equipo de trabajo:", options: ["Se realiza una labor similar de forma autónoma.", "No existe coordinación de tareas.", "Se realizan labores diferentes pero complementarias."], correctAnswerIndex: 2 },
            { questionText: "El término sinergia significa:", options: ["Siniestralidad.", "Entendimiento.", "Cooperación."], correctAnswerIndex: 2 },
            { questionText: "Formar un equipo de trabajo supone tiempo pero a la larga se observa cómo es un tiempo muy bien invertido, puesto que repercutirá en:", options: ["Mayor productividad.", "Mejor cooperación.", "Existirá un menor sentimiento de compromiso."], correctAnswerIndex: 0 },
            { questionText: "Entre las tareas que realiza un operario de almacén no se encuentra:", options: ["Se encarga de la limpieza del almacén.", "Tiene como tarea actualizar inventarios.", "Elabora el documento albarán que acompaña a la mercancía."], correctAnswerIndex: 2 },
            { questionText: "La comunicación en la empresa se producirá de manera:", options: ["Ascendente.", "Mixta.", "Diagonal."], correctAnswerIndex: 1 },
            // Page 31
            { questionText: "La comunicación horizontal es la que se produce entre:", options: ["Superiores.", "Departamentos.", "Con el exterior."], correctAnswerIndex: 1 },
            { questionText: "La confianza supone que cada trabajador ha de interiorizar que los compañeros del equipo desarrollan sus tareas de la mejor manera posible.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "Cuál de los siguientes indicadores no nos proporcionará información sobre la calidad de un servicio:", options: ["Eficacia.", "Puntualidad.", "Gestión."], correctAnswerIndex: 2 },
            { questionText: "El uso de las medidas de protección nos evitará:", options: ["Pago de multas.", "Pérdidas de rentabilidad.", "Ahorra de tiempo de trabajo."], correctAnswerIndex: 1 },
            { questionText: "La persona asertiva es capaz de transmitir sus inquietudes y a la vez defender su posición no respetando la opinión de otros.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 1 },
            { questionText: "Cuál de las siguientes afirmaciones es incorrecta.", options: ["Cuando el espacio es limitado, el almacenamiento en altura no es la solución.", "El pavimento que tenemos en nuestro almacén será otro de los puntos a tener en cuenta puesto que su buen estado facilitará el tránsito por él y el movimiento de los equipos de cargas y mercancías.", "Tenemos la posibilidad de mecanizar o automatizar las estanterías del almacén."], correctAnswerIndex: 0 },
            // Page 32
            { questionText: "El método LIFO de gestión de existencias significa:", options: ["Las existencias introducidas serán sacadas oportunamente.", "El último que entra el primero que sale.", "El primero que entra el primero que sale."], correctAnswerIndex: 1 },
            { questionText: "De las siguientes afirmaciones señala la incorrecta. Los palés metálicos:", options: ["Tienen una gran resistencia.", "Su vida útil es corta.", "Soportan pesos entre 1000-1200 kg."], correctAnswerIndex: 1 },
            { questionText: "Existe la posibilidad de utilizar palés de cartón:", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "Podemos diferenciar tres características de los envases. Señala la opción verdadera:", options: ["Envase primario se encuentra en completo contacto con el producto hasta su consumo.", "Envase primario envolverá varios envases secundarios o un pack de artículos.", "Envase primario. Nos facilita su manipulación, almacenaje, distribución o transporte."], correctAnswerIndex: 0 },
            { questionText: "De las siguientes características de los envases y embalajes señala la opción incorrecta.", options: ["Un buen envasado nos permitirá no tener pérdidas de producto.", "El envase será el medio de comunicación que exista entre el fabricante y el consumidor final.", "El estado de conservación del producto dentro del envase se hará con las mayores garantías sin evitar que entre en contacto con factores contaminantes."], correctAnswerIndex: 2 },
            // Page 33
            { questionText: "De los siguientes materiales de envases señala el más problemático por su composición y exposición al exterior:", options: ["Madera.", "Metal.", "Plástico."], correctAnswerIndex: 2 },
            { questionText: "En la gestión de residuos tenemos dos opciones. Señala cuál de los dos sistemas es el que consiste en el que el consumidor pagará una cantidad por el envase y una vez consumido el producto lo devolverá al comercio y este le devolverá la parte del precio cobrada por el envase.", options: ["Sistema integrado de gestión de residuos de envases y envases usados (SIG).", "Sistema de depósito, devolución y retorno."], correctAnswerIndex: 1 },
            { questionText: "Los precintos cumplen las siguientes características: señala la opción incorrecta.", options: ["Los precintos deben ser difícilmente falsificables.", "Deben de ser resistentes y de fácil rotura.", "El precinto es símbolo de garantía."], correctAnswerIndex: 1 },
            { questionText: "Los equipos de movimiento de cargas pueden ser: señala la opción incorrecta.", options: ["De accionamiento manual.", "De accionamiento electromecánico.", "De accionamiento hibrido."], correctAnswerIndex: 2 },
            // Page 34
            { questionText: "El sistema RFID es un sistema de seguimiento a través de:", options: ["Radiofrecuencias.", "Ondas.", "Cable."], correctAnswerIndex: 0 },
            { questionText: "La codificación de los productos en el almacén no se hará utilizando un sistema:", options: ["Numérico.", "Alfanumérico.", "De símbolos."], correctAnswerIndex: 2 },
            { questionText: "Señala la opción correcta.", options: ["La codificación significativa no se basa solo en la aplicación o asignación de unos caracteres, sino que esa aplicación nos aporta información añadida del producto.", "En la codificación significativa se aplican unos caracteres sin que ese código que se crea nos añada ninguna información sobre la mercancía.", "La ventaja de la codificación significativa es la simplicidad y facilidad de aplicación, pero tiene un inconveniente y es que los fallos de código son difícilmente subsanables."], correctAnswerIndex: 0 },
            { questionText: "Los códigos de barras se representan. Señala la opción incorrecta.", options: ["Con unas líneas paralelas estrechas y anchas de color oscuro (por ejemplo, rojo y no recomendable metalizado).", "Sobre fondo claro y con ciertas separaciones entre ellas.", "En la parte de abajo aparecerá una numeración que será la representación de las líneas de la parte superior."], correctAnswerIndex: 0 },
            { questionText: "La estructura del código GTIN 13 ο EAN13 se detalla a continuación:", options: ["Los dos primeros números del código identifican al país de origen del producto, el siguiente bloque de números identifican al fabricante, el siguiente al producto y por último encontramos un dígito de control.", "Los tres primeros números del código identifican al país de origen del producto, el siguiente bloque de números identifican al fabricante, el siguiente al producto y por último encontramos un dígito de control.", "Los dos primeros números del código identifican al país de origen del producto, el siguiente bloque de números identifican al fabricante y el siguiente al producto."], correctAnswerIndex: 1 },
            // Page 35
            { questionText: "Señala la opción correcta:", options: ["El código EAN14 es la actualización del antiguo código EAN13.", "El código EAN14 identifica agrupaciones de productos.", "El código EAN14 se creó en el año 2014."], correctAnswerIndex: 1 },
            { questionText: "La etiqueta será el elemento que nos permita identificar un determinado producto y que a la vez nos informe sobre características como: composición, restricciones, formas de usarlo, etc.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "La etiqueta:", options: ["Será de un material poco resistente.", "La etiqueta debe contener una información, bien porque es obligatorio y una normativa se lo exige o bien porque es una información opcional y útil que se quiere facilitar al consumidor.", "Se deben situar en lugar visible."], correctAnswerIndex: 1 },
            { questionText: "El lector del código de barras. Elige la opción incorrecta.", options: ["Se puede definir como el equipo que escanea por medio de un láser y es capaz de leer un código de barras.", "Los códigos de barras alojan información criptada.", "Tenemos la posibilidad de trabajar con tecnología alámbrica o inalámbrica (a través de bluetooth)."], correctAnswerIndex: 1 },
            { questionText: "Señala la opción incorrecta", options: ["El lector podrá hacer una lectura láser o imagers. Existen algunas diferencias en la utilización de ambas tecnologías.", "La lectura láser se produce a través de una línea de luz pulsada sobre el código de barras.", "Los lectores digitales imagers proyectan una luz led sobre los códigos pudiendo leer códigos 3D y 4D."], correctAnswerIndex: 2 },
            // Page 36
            { questionText: "La Ley de Prevención de Riesgos Laborales (31/1995, de 8 de noviembre) establece los principios generales relativos a... (Señala la incorrecta).", options: ["Prevención de los riesgos profesionales y la protección de la seguridad y la salud.", "Disminución y eliminación de los riesgos derivados del trabajo.", "La información, formación, consulta y participación de los empresarios."], correctAnswerIndex: 2 },
            { questionText: "De los siguientes conceptos básicos sobre seguridad. Señala la opción incorrecta:", options: ["Ergonomía: se encarga del estudio de las posiciones del cuerpo humano en relación con las adoptadas en el trabajo.", "Accidente de trabajo: toda lesión corporal que sufre el trabajador con ocasión o por consecuencia del trabajo ejecutado por cuenta ajena.", "Riesgo: posibilidad de que un trabajador sufra un daño en término de lesiones a consecuencia del trabajo."], correctAnswerIndex: 0 },
            { questionText: "Será una caída habitual del personal del almacén al mismo nivel:", options: ["Tropiezo con elementos mal almacenados que invaden las zonas de paso.", "Utilización de escaleras manuales.", "Descarga de camiones."], correctAnswerIndex: 0 },
            { questionText: "El empresario tendrá entre otras obligaciones: actuar en caso de riesgo grave o inminente y suministrar los EPI a los trabajadores. La formación correrá a cargo de los sindicatos.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 1 },
            // Page 37
            { questionText: "Señala la opción incorrecta:", options: ["La empresa debe formar a los trabajadores en temas de prevención, primeros auxilios, incendios y evacuación.", "Los trabajadores deben recibir una formación general en materia de riesgos en la empresa, así como de la específica en su puesto de trabajo.", "La formación debe ser finalista, al inicio del contrato y continua durante los tres primeros meses en la empresa."], correctAnswerIndex: 2 },
            { questionText: "El calzado de seguridad debe proteger frente a:", options: ["Lesiones en los pies producidas por acciones internas.", "Riesgos para las personas por una acción sobre la piel.", "Riesgos para la salud o molestias vinculados al uso del calzado."], correctAnswerIndex: 0 },
            { questionText: "Dentro de la ropa con protección y dependiendo de su uso distinguimos:", options: ["Ropa de protección térmica (UNE-EN 342): para uso en el exterior debido a bajas temperaturas.", "La ropa reflectante de alta visibilidad (viene regulada por la norma UNE-EN 471) para zonas donde circulen vehículos.", "Protección contra la intemperie (UNE-EN 343) en almacenajes en el interior."], correctAnswerIndex: 1 },
            { questionText: "La protección de los oídos se producirá cuando el ruido ambiental supere:", options: ["Los 65 dB.", "Los 80 dB.", "Los 120 dB."], correctAnswerIndex: 1 },
            { questionText: "A la hora de levantar objetos pesados:", options: ["Nos posicionaremos frente a la carga con los pies juntos para mantener el equilibrio.", "Mantener la espalda recta.", "Procuraremos girar el tronco con carga."], correctAnswerIndex: 1 },
            // Page 38
            { questionText: "Los muelles de carga deberán estar señalizados para evitar riesgos (caídas al encontrarse elevados para facilitar el descargado de camiones. Obligatoriamente dispondrán de una valla de protección para evitar las caídas.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "El mantenimiento de equipos lo podemos dividir en... (Señala la opción incorrecta).", options: ["Mantenimiento preventivo: son labores de revisión del equipo que se llevan a cabo sin que se haya producido deterioro del equipo para su correcto funcionamiento.", "Mantenimiento correctivo: se lleva a cabo para subsanar una avería o rotura en el equipo de trabajo con la finalidad de devolverlo a sus condiciones de trabajo.", "Mantenimiento de oportunidad: se lleva a cabo según los intervalos de mantenimiento establecidos por el fabricante."], correctAnswerIndex: 2 },
            { questionText: "Los periodos de mantenimiento se reflejarán en:", options: ["Horas de uso del equipo.", "Kilómetros de recorrido.", "Ambas son correctas."], correctAnswerIndex: 2 },
            { questionText: "Las garantías comerciales son el compromiso asumido por un vendedor o un productor con respecto al consumidor, de no reembolsar el precio pagado por un bien, o de ocuparse del bien en caso de que no corresponda a las condiciones enunciadas en la declaración de garantía o en la publicidad correspondiente.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 1 },
            { questionText: "Señala la opción correcta:", options: ["Los productos de segunda mano adquiridos a un profesional también están sujetos a un periodo de garantía de dos años.", "Existe garantía europea de dos años para equipos de nueva adquisición, desde su adquisición."], correctAnswerIndex: 1 },
            // Page 39
            { questionText: "Se considera residuos peligrosos y no como residuos sólidos urbanos:", options: ["Aceites lubricantes.", "Fluidos hidrotermales.", "Aceites vegetales."], correctAnswerIndex: 0 },
            { questionText: "Las carretillas elevadoras pueden disponer básicamente de dos tipos de unidades de tracción: motor térmico y motor eléctrico.", options: ["Verdadero.", "Falso."], correctAnswerIndex: 0 },
            { questionText: "El sistema de lubricación se encarga de:", options: ["Llevar el combustible del depósito al motor donde se produce la combustión.", "Engrasar las piezas móviles del motor para evitar desgastes y gripajes por rozamiento.", "Ninguna opción es correcta."], correctAnswerIndex: 1 },
            { questionText: "Los neumáticos de las carretillas elevadoras pueden ser de tres tipos. Señala la opción correcta.", options: ["Superelásticas: son completamente macizas pero compuestas de diferentes materiales, siendo las más comunes.", "De bandaje: tienen el inconveniente de no mantener de la misma manera la estabilidad dimensional.", "De bandaje: son completamente macizas pero compuestas de diferentes materiales, siendo las más comunes."], correctAnswerIndex: 0 },
            { questionText: "En el transporte de mercancía peligrosa se deben tener en cuenta lo siguiente. Señala la opción incorrecta.", options: ["Centrar y estabilizar la carga.", "Los recipientes deberán ir en posición horizontal.", "Reducir la velocidad del transporte."], correctAnswerIndex: 1 },
            // Page 40
            { questionText: "¿Qué ventaja tiene el \"Sistema de estantería con base móvil (MovaRack)\"?", options: ["Malo aprovechamiento del espacio.", "Buen aprovechamiento del espacio (solo 1 pasillo), pero mucho mantenimiento.", "Ni FiFo ni LiFo.", "Para productos de baja rotación solo."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/vH2JdYhn/Almacenaje-m-vil.jpg" },
            { questionText: "¿Para qué rotación es ideal el \"Sistema Automático\"?", options: ["Baja rotación.", "Alta rotación.", "Sin rotación específica.", "Solo media."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/J4YfWrx1/Sistema-autom-ticos.jpg" },
            { questionText: "¿Qué es un \"Sistema Autoportante\"?", options: ["Estantería convencional con base móvil.", "Estructura integrada donde las estanterías forman parte del edificio, con alta rotación y mucho mantenimiento.", "Sistema manual.", "Para productos pequeños."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/HsvqCYz7/Sistema-autoportante.jpg" },
            { questionText: "¿Para qué se utiliza principalmente el \"Sistema Cantilever\"?", options: ["Productos pequeños y frágiles.", "Productos largos, con aprovechamiento del espacio malo y poco mantenimiento.", "Mercancías peligrosas.", "Alta compactación."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/c4kpNxhn/Sistema-Cantilever.jpg" },
            // Page 41
            { questionText: "¿Qué incluye el \"Sistema Automático\" como transelevadores, miniload, bilateral o trilateral?", options: ["Solo LiFo, espacio malo.", "LiFo, FiFo o FeFo; buena espacio (hasta 30m altura), máximo mantenimiento, extremadamente rígido.", "Poco mantenimiento.", "Para baja rotación."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/L6QcM9Df/Sistema-de-almacenamiento-din-mico.jpg" },
            { questionText: "¿Cuáles son las características principales del \"Sistema de estantería convencional o Rack System\"?", options: ["FiFo, buen espacio, mucho mantenimiento.", "Ni FiFo, ni LiFo, ni FeFo; aprovechamiento del espacio malo, poco mantenimiento, sistema flexible.", "Solo para productos largos.", "Accesibilidad limitada."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/T3yZdzNg/Sistema-de-estanter-a-convencional-o-Rack-sistema.jpg" },
            { questionText: "¿Qué ventaja ofrece el \"Sistema de estanterías dinámicas por gravedad\"?", options: ["LiFo, 1 pasillo.", "FiFo, espacio bueno (2 pasillos, una unidad de carga), mucho mantenimiento, muy rígido.", "Poco mantenimiento.", "Flexible."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/cLKVxpkF/Sistema-de-estanter-as-din-micas-Din-micas-por-gravedad.png" },
            // Page 42
            { questionText: "Cuáles son las características del \"Sistema Flow Rail\"?", options: ["FiFo, espacio muy bueno.", "Ni FiFo, ni LiFo, ni FeFo; aprovechamiento del espacio intermedio, mucho mantenimiento.", "Sin mantenimiento.", "Rígido para productos largos."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/QdBR82Y6/Sistema-de-estanter-as-din-micas-Estanter-as-shuttle-lanzadera.jpg" },
            { questionText: "¿Qué rotación y características tiene el \"Sistema Push Back\"?", options: ["FiFo, espacio intermedio.", "LiFo, buen espacio (1 pasillo), mucho mantenimiento, muy rígido.", "FeFo, sin mantenimiento.", "Para productos largos."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/L8qr9cQt/Sistema-de-estanter-as-din-micas-push-back.jpg" },
            { questionText: "¿Qué describe al sistema \"Drive Through\"?", options: ["LiFo, un pasillo.", "FiFo, buen espacio (pero necesita 2 pasillos), poco mantenimiento, rígido.", "Ni FiFo ni LiFo.", "Solo alta rotación."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/htJHDkZN/Sistema-Drive-through.png" },
            { questionText: "¿Qué describe al \"Sistema Drive In\"?", options: ["FiFo, necesita 2 pasillos.", "LiFo, solo un espacio de carga, poco mantenimiento, rígido.", "Mucho mantenimiento.", "Flexible para cualquier referencia."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/6p7DWkb1/Sistema-Driven-in.jpg" },
            { questionText: "¿Qué rotación utiliza el \"Sistema en bloque\"?", options: ["FiFo.", "LiFo, con aprovechamiento del espacio muy bueno y sin mantenimiento.", "FeFo.", "Ni uno ni otro."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/BndRXmd3/Sistema-en-bloque.jpg" },
            // Page 43
            { questionText: "¿Cuáles son las características del \"Sistema Flow Rail\"?", options: ["FiFo, espacio muy bueno.", "Ni FiFo, ni LiFo, ni FeFo; aprovechamiento del espacio intermedio, mucho mantenimiento.", "Sin mantenimiento.", "Rígido para productos largos."], correctAnswerIndex: 1, imageUrl: "https://i.postimg.cc/kgkLBTLf/Sistema-Flow-rail.jpg" },
            { questionText: "¿Qué se hace en el mantenimiento de oportunidad?", options: ["Se repara después de una avería.", "Se aprovecha para reparar elementos que no corresponden en ese momento durante otras operaciones.", "Se realiza solo por empresas homologadas.", "Se investiga el origen de anomalías."], correctAnswerIndex: 1 },
            { questionText: "El mantenimiento correctivo se realiza antes de que ocurra una avería.", options: ["Verdadero", "Falso"], correctAnswerIndex: 1 },
            { questionText: "El mantenimiento obligatorio está regulado por una ________ y se realiza por empresas ________.", options: ["norma / homologadas", "ley / acreditadas", "instrucción / certificadas", "manual / autorizadas"], correctAnswerIndex: 0 },
            // Page 44
            { questionText: "¿Cuáles son características del almacenamiento no planificado de equipos?", options: ["Siempre limpio y fácil acceso.", "Se pierde tiempo en búsqueda y puede provocar accidentes.", "Condiciones que no estropeen el equipo.", "No obstruye zonas de seguridad."], correctAnswerIndex: 1 },
            { questionText: "En el almacenamiento planificado, los equipos se guardan en condiciones que evitan humedad, goteras o heladas.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: "¿Qué implica el mantenimiento preventivo?", options: ["Investigar anomalías detectadas.", "Realizar comprobaciones y operaciones mandadas por el fabricante, según el libro de trabajo.", "Reparar después de una avería.", "Aprovechar oportunidades durante otras operaciones."], correctAnswerIndex: 1 },
            { questionText: "En el mantenimiento predictivo, ante anomalías o mediciones, se investiga su ________.", options: ["origen", "duración", "coste", "frecuencia"], correctAnswerIndex: 0 },
            { questionText: "¿Cuál es uno de los motivos del mantenimiento?", options: ["Aumentar las paradas extraordinarias.", "Ahorro de dinero por roturas no controladas.", "Ignorar la seguridad.", "Reducir el funcionamiento correcto."], correctAnswerIndex: 1 },
            // Page 45
            { questionText: "Los fabricantes deben proporcionar piezas de repuesto durante 10 años después de que el producto deje de fabricarse.", options: ["Verdadero", "Falso"], correctAnswerIndex: 0 },
            { questionText: '¿Qué incluye el marcado "CE" en los equipos?', options: ["Es una marca exclusiva de China Export.", "Indica que está fabricado conforme a un expediente técnico y es una máquina segura.", "Solo garantiza 3 años de garantía.", "No requiere manual en español."], correctAnswerIndex: 1 }
        ];

        const allQuestionsWithIndex = allQuestions.map((q, index) => ({ ...q, originalIndex: index }));

        // DOM Elements
        const nameScreen = document.getElementById('name-screen');
        const nameInput = document.getElementById('name-input');
        const submitNameBtn = document.getElementById('submit-name-btn');
        const welcomeMessage = document.getElementById('welcome-message');
        const startScreen = document.getElementById('start-screen');
        const startScreenDefaultContent = document.getElementById('start-screen-default-content');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const startBtn = document.getElementById('start-quiz-btn');
        const progressText = document.getElementById('progress-text');
        const timerEl = document.getElementById('timer');
        const questionImageContainer = document.getElementById('question-image-container');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const nextButtonContainer = document.getElementById('next-button-container');
        const resultsTitle = document.getElementById('results-title');
        const resultsMessage = document.getElementById('results-message');
        const finalTimeEl = document.getElementById('final-time');
        const scoreDisplay = document.getElementById('score-display');
        const scorePercentage = document.getElementById('score-percentage');
        const resultsButtons = document.getElementById('results-buttons');
        const reviewSection = document.getElementById('review-section');
        const incorrectList = document.getElementById('incorrect-questions-list');
        
        // Search elements
        const searchInput = document.getElementById('search-input');
        const searchResultsContainer = document.getElementById('search-results-container');
        const searchResultsList = document.getElementById('search-results-list');
        const noResultsMessage = document.getElementById('no-results-message');
        const topicQuizButtonContainer = document.getElementById('topic-quiz-button-container');

        // Bookmark elements
        const bookmarkBtn = document.getElementById('bookmark-btn');
        const bookmarksContainer = document.getElementById('bookmarks-container');
        const bookmarksList = document.getElementById('bookmarks-list');
        const bookmarkQuizButtonContainer = document.getElementById('bookmark-quiz-button-container');

        // State
        let username = '';
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let selectedAnswers = [];
        let score = 0;
        let startTime = 0;
        let timerInterval;
        let wakeLock = null;
        let bookmarkedQuestions = new Set();
        const BOOKMARKS_STORAGE_KEY = 'logisticsQuizBookmarks';
        const bookmarkIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" /></svg>`;
        const bookmarkedIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-500" viewBox="0 0 20 20" fill="currentColor"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z" /></svg>`;

        // Bookmark Functions
        const loadBookmarks = () => {
            const storedBookmarks = localStorage.getItem(BOOKMARKS_STORAGE_KEY);
            if (storedBookmarks) {
                bookmarkedQuestions = new Set(JSON.parse(storedBookmarks));
            }
        };

        const saveBookmarks = () => {
            localStorage.setItem(BOOKMARKS_STORAGE_KEY, JSON.stringify(Array.from(bookmarkedQuestions)));
        };

        const removeBookmark = (originalIndex) => {
            bookmarkedQuestions.delete(originalIndex);
            saveBookmarks();
            renderBookmarksSection();
        };

        const startBookmarkedQuiz = () => {
            const bookmarkedQuizQuestions = allQuestionsWithIndex.filter(q => bookmarkedQuestions.has(q.originalIndex));
            if (bookmarkedQuizQuestions.length > 0) {
                startQuiz(shuffleArray(bookmarkedQuizQuestions));
            }
        };

        const renderBookmarksSection = () => {
            if (bookmarkedQuestions.size > 0) {
                bookmarksContainer.classList.remove('hidden');
                bookmarksList.innerHTML = '';
                bookmarkQuizButtonContainer.innerHTML = '';

                const questionsToRender = allQuestionsWithIndex.filter(q => bookmarkedQuestions.has(q.originalIndex));

                questionsToRender.forEach(q => {
                    const li = document.createElement('li');
                    li.className = 'p-3 bg-gray-50 rounded-md flex justify-between items-center';
                    li.innerHTML = `<p class="text-gray-800 text-sm mr-2">${q.questionText}</p>`;

                    const removeButton = document.createElement('button');
                    removeButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500 hover:text-red-700" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>`;
                    removeButton.className = 'ml-4 p-1 rounded-full hover:bg-red-100 flex-shrink-0';
                    removeButton.setAttribute('aria-label', 'Eliminar marcador');
                    removeButton.onclick = () => removeBookmark(q.originalIndex);

                    li.appendChild(removeButton);
                    bookmarksList.appendChild(li);
                });

                const startBtn = document.createElement('button');
                startBtn.textContent = `Iniciar Test de Preguntas Guardadas (${bookmarkedQuestions.size})`;
                startBtn.className = 'px-6 py-3 text-lg font-bold text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-transform transform hover:scale-105 shadow-md';
                startBtn.onclick = startBookmarkedQuiz;
                bookmarkQuizButtonContainer.appendChild(startBtn);

            } else {
                bookmarksContainer.classList.add('hidden');
            }
        };

        const handleBookmarkToggle = () => {
            const question = currentQuestions[currentQuestionIndex];
            if (!question) return;

            const { originalIndex } = question;
            if (bookmarkedQuestions.has(originalIndex)) {
                bookmarkedQuestions.delete(originalIndex);
                bookmarkBtn.innerHTML = bookmarkIconSVG;
                bookmarkBtn.setAttribute('aria-label', 'Guardar pregunta');
            } else {
                bookmarkedQuestions.add(originalIndex);
                bookmarkBtn.innerHTML = bookmarkedIconSVG;
                bookmarkBtn.setAttribute('aria-label', 'Pregunta guardada');
            }
            saveBookmarks();
        };

        // Screen Wake Lock API
        const requestWakeLock = async () => {
            if ('wakeLock' in navigator) {
                try {
                    wakeLock = await navigator.wakeLock.request('screen');
                    wakeLock.addEventListener('release', () => {});
                } catch (err) {
                    console.error('Screen Wake Lock request failed:', err);
                }
            }
        };

        const releaseWakeLock = async () => {
            if (wakeLock !== null) {
                try {
                    await wakeLock.release();
                    wakeLock = null;
                } catch (err) {
                    console.error('Screen Wake Lock release failed:', err);
                }
            }
        };
        
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible' && !quizScreen.classList.contains('hidden')) {
                requestWakeLock();
            }
        });

        // Utility Functions
        const shuffleArray = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        };

        const formatTime = (totalSeconds) => {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        };
        
        const updateTimer = () => {
            const elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
            timerEl.textContent = formatTime(elapsedSeconds);
        };

        const showScreen = (screen) => {
            nameScreen.classList.add('hidden');
            startScreen.classList.add('hidden');
            quizScreen.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            screen.classList.remove('hidden');
            if (screen === startScreen) {
                renderBookmarksSection();
            }
        };
        
        const handleNameSubmit = () => {
            const name = nameInput.value.trim();
            username = name || 'Amigo';
            welcomeMessage.textContent = `¡Hola, ${username}! Pon a prueba tus conocimientos.`;
            showScreen(startScreen);
        };

        // Quiz Logic
        const startQuiz = (questions) => {
            currentQuestions = questions;
            currentQuestionIndex = 0;
            score = 0;
            selectedAnswers = Array(questions.length).fill(null);

            startTime = Date.now();
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 1000);
            updateTimer();
            
            requestWakeLock();
            
            showScreen(quizScreen);
            renderQuestion();
        };
        
        const startNewQuiz = () => {
            const imageQuestions = allQuestionsWithIndex.filter(q => q.imageUrl);
            const textQuestions = allQuestionsWithIndex.filter(q => !q.imageUrl);

            const shuffledImageQs = shuffleArray([...imageQuestions]);
            const shuffledTextQs = shuffleArray([...textQuestions]);

            const minImg = 2;
            const maxImg = 4;
            let numImageQs = Math.floor(Math.random() * (maxImg - minImg + 1)) + minImg;
            
            numImageQs = Math.min(numImageQs, shuffledImageQs.length);

            const numTextQs = 20 - numImageQs;

            const quizQuestions = [
                ...shuffledImageQs.slice(0, numImageQs),
                ...shuffledTextQs.slice(0, numTextQs)
            ];

            const finalShuffledQuiz = shuffleArray(quizQuestions);
            startQuiz(finalShuffledQuiz);
        };
        
        const renderQuestion = () => {
            const question = currentQuestions[currentQuestionIndex];
            
            questionImageContainer.innerHTML = '';
            if (question.imageUrl) {
                const img = document.createElement('img');
                img.src = question.imageUrl;
                img.alt = "Imagen del sistema de almacenaje";
                img.className = "w-full h-auto max-h-60 object-contain mx-auto rounded-lg";
                questionImageContainer.appendChild(img);
            }

            progressText.textContent = `Pregunta ${currentQuestionIndex + 1} / ${currentQuestions.length}`;
            questionTextEl.innerHTML = question.questionText;

            optionsContainer.innerHTML = '';
            const optionPrefixes = ['A', 'B', 'C', 'D'];
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerHTML = `<span class="mr-3 font-bold text-blue-600">${optionPrefixes[index]}</span>${option}`;
                button.className = 'p-4 rounded-lg text-left font-semibold transition-all duration-300 border-2 bg-white text-gray-700 border-gray-300 hover:bg-blue-50 hover:border-blue-500';
                button.onclick = () => handleAnswer(index);
                optionsContainer.appendChild(button);
            });
            
            // Update bookmark button state
            if (bookmarkedQuestions.has(question.originalIndex)) {
                bookmarkBtn.innerHTML = bookmarkedIconSVG;
                bookmarkBtn.setAttribute('aria-label', 'Pregunta guardada');
            } else {
                bookmarkBtn.innerHTML = bookmarkIconSVG;
                bookmarkBtn.setAttribute('aria-label', 'Guardar pregunta');
            }

            nextButtonContainer.innerHTML = '';
        };

        const handleAnswer = (selectedIndex) => {
            selectedAnswers[currentQuestionIndex] = selectedIndex;
            const question = currentQuestions[currentQuestionIndex];
            const isCorrect = selectedIndex === question.correctAnswerIndex;
            if (isCorrect) {
                score++;
            }

            Array.from(optionsContainer.children).forEach((btn, i) => {
                btn.disabled = true;
                btn.classList.add('disabled');
                if (i === question.correctAnswerIndex) {
                    btn.classList.add('correct');
                } else if (i === selectedIndex) {
                    btn.classList.add('incorrect');
                }
            });

            renderNextButton();
        };

        const renderNextButton = () => {
            const isLastQuestion = currentQuestionIndex === currentQuestions.length - 1;
            const button = document.createElement('button');
            button.textContent = isLastQuestion ? 'Finalizar Test' : 'Siguiente Pregunta';
            button.className = 'px-8 py-3 text-lg font-bold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 shadow-md';
            button.onclick = handleNextQuestion;
            nextButtonContainer.innerHTML = '';
            nextButtonContainer.appendChild(button);
        };

        const handleNextQuestion = () => {
            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
            } else {
                finishQuiz();
            }
        };

        const finishQuiz = () => {
            clearInterval(timerInterval);
            releaseWakeLock();
            const elapsedTime = Math.round((Date.now() - startTime) / 1000);
            
            const incorrectQuestions = currentQuestions.filter((q, index) => selectedAnswers[index] !== q.correctAnswerIndex);
            const isPerfectScore = incorrectQuestions.length === 0;
            const percentage = Math.round((score / currentQuestions.length) * 100);

            resultsTitle.textContent = isPerfectScore ? '¡Excelente!' : 'Test Completado';
            resultsMessage.textContent = isPerfectScore ? `¡Felicidades, ${username}! Has respondido correctamente a todas las preguntas.` : `¡Buen trabajo, ${username}! Tu resultado final es:`;
            finalTimeEl.textContent = `Tiempo total: ${formatTime(elapsedTime)}`;
            scoreDisplay.textContent = `${score} / ${currentQuestions.length}`;
            scorePercentage.textContent = `${percentage}%`;

            resultsButtons.innerHTML = '';
            if (!isPerfectScore) {
                const retryBtn = document.createElement('button');
                retryBtn.textContent = `Repetir Errores (${incorrectQuestions.length})`;
                retryBtn.className = "w-full md:w-auto px-6 py-3 text-lg font-bold text-white bg-green-600 rounded-lg hover:bg-green-700 transition-transform transform hover:scale-105 shadow-md hover:shadow-lg";
                retryBtn.onclick = () => startQuiz(incorrectQuestions);
                resultsButtons.appendChild(retryBtn);
            }
            const resetBtn = document.createElement('button');
            resetBtn.textContent = 'Empezar Nuevo Test';
            resetBtn.className = "w-full md:w-auto px-6 py-3 text-lg font-bold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 shadow-md hover:shadow-lg";
            resetBtn.onclick = () => {
                showScreen(startScreen);
                showStartScreenView();
            };
            resultsButtons.appendChild(resetBtn);

            if (!isPerfectScore) {
                incorrectList.innerHTML = '';
                incorrectQuestions.forEach(q => {
                    const li = document.createElement('li');
                    li.className = 'text-gray-700 border-b border-gray-200 py-2 last:border-b-0';
                    li.innerHTML = `<p class="font-semibold">${q.questionText}</p>
                                    <p class="text-green-700 text-sm mt-1">
                                      <span class="font-bold">Respuesta correcta:</span> ${q.options[q.correctAnswerIndex]}
                                    </p>`;
                    incorrectList.appendChild(li);
                });
                reviewSection.classList.remove('hidden');
            } else {
                reviewSection.classList.add('hidden');
            }
            
            showScreen(resultsScreen);
        };

        // Search Logic
        const handleSearch = () => {
            const searchTerm = searchInput.value.trim().toLowerCase();
            if (searchTerm === '') {
                showStartScreenView();
                return;
            }

            const results = allQuestionsWithIndex.filter(q => q.questionText.toLowerCase().includes(searchTerm));

            renderSearchResults(results, searchTerm);
        };

        const renderSearchResults = (results, searchTerm) => {
            startScreenDefaultContent.classList.add('hidden');
            searchResultsContainer.classList.remove('hidden');
            searchResultsList.innerHTML = '';
            topicQuizButtonContainer.innerHTML = '';

            if (results.length > 0) {
                noResultsMessage.classList.add('hidden');
                
                results.forEach(q => {
                    const li = document.createElement('li');
                    li.className = 'p-3 bg-gray-50 rounded-md flex justify-between items-center';
                    li.innerHTML = `<p class="text-gray-800">${q.questionText}</p>`;
                    
                    const startButton = document.createElement('button');
                    startButton.textContent = 'Empezar Test';
                    startButton.className = 'ml-4 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 whitespace-nowrap';
                    startButton.onclick = () => startQuizFromSearch(q.originalIndex);
                    
                    li.appendChild(startButton);
                    searchResultsList.appendChild(li);
                });

                const topicButton = document.createElement('button');
                topicButton.textContent = `Iniciar Test del Tema "${searchTerm}" (${results.length} preguntas)`;
                topicButton.className = 'px-6 py-3 text-lg font-bold text-white bg-purple-600 rounded-lg hover:bg-purple-700 transition-transform transform hover:scale-105 shadow-md';
                topicButton.onclick = () => startQuiz(results);
                topicQuizButtonContainer.appendChild(topicButton);

            } else {
                noResultsMessage.classList.remove('hidden');
            }
        };

        const startQuizFromSearch = (questionIndex) => {
            const selectedQuestion = allQuestionsWithIndex.find(q => q.originalIndex === questionIndex);
            
            const otherQuestions = allQuestionsWithIndex.filter((q) => q.originalIndex !== questionIndex);
            const shuffledOthers = shuffleArray(otherQuestions).slice(0, 19);

            const quizQuestions = shuffleArray([selectedQuestion, ...shuffledOthers]);
            startQuiz(quizQuestions);
        };

        const showStartScreenView = () => {
            searchResultsContainer.classList.add('hidden');
            topicQuizButtonContainer.innerHTML = '';
            startScreenDefaultContent.classList.remove('hidden');
            searchInput.value = '';
        };

        // Initial Setup
        const initializeApp = () => {
            loadBookmarks();
            renderBookmarksSection();

            submitNameBtn.addEventListener('click', handleNameSubmit);
            nameInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    handleNameSubmit();
                }
            });
            startBtn.addEventListener('click', startNewQuiz);
            searchInput.addEventListener('input', handleSearch);
            bookmarkBtn.addEventListener('click', handleBookmarkToggle);
            
            // Register Service Worker for PWA
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    // Construct the full URL to the service worker to avoid origin mismatches in specific environments.
                    const swUrl = `${window.location.origin}/service-worker.js`;
                    navigator.serviceWorker.register(swUrl)
                        .then(reg => console.log('Service worker registered.', reg))
                        .catch(err => console.error('Service worker not registered.', err, 'Attempted URL:', swUrl));
                });
            }
        };

        initializeApp();

    </script>
</body>
</html>